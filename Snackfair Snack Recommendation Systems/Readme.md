# Snack Recommendation System using Collaborative Filtering
![Alt Text](https://github.com/rhnyewale/INFO7374-Algorithmic-Digital-Marketing/blob/master/Assignment%204%20-%20Snack%20Recommender%20System/Images/rec_intro.jpg)

## Claat Document
https://codelabs-preview.appspot.com/?file_id=1tSvgU97gZs9jBNQsJ7ieuNkPW0yk5OedaKW4uQzAXzE#1
## Dataset
<b>Folder Dataset/:</b></br>
<b>FinalFoodData.csv</b> contains 425 food items with category and description(calories,sugar,fat,protien)</br>
<b>InputFoodData.csv</b> contains 60k entries with 900+ users rating 425 food items </br>
<b>Reference:</b> https://tools.myfooddata.com/nutrition-facts-database-spreadsheet.php</br>
## Getting Started

To setup on your local machine:

1. Install Anaconda with Python >= 3.6. [Miniconda](https://conda.io/miniconda.html) is a quick way to get started.

2. Clone the repository

```
git clone https://github.com/Microsoft/Recommenders
```

3. Run the generate conda file script to create a conda environment: (This is for a basic python environment, see [SETUP.md](SETUP.md) for PySpark and GPU environment setup)

```
cd Recommenders
python tools/generate_conda_file.py
conda env create -f reco_base.yaml  
```

4. Activate the conda environment and register it with Jupyter:

```
conda activate reco_base
python -m ipykernel install --user --name reco_base --display-name "Python (reco)"
```

5. Start the Jupyter notebook server

## How to run the Notebooks
Once you setup the environment from Jupyter/Notebook: folder copy the notebooks to ..\Recommenders\examples\00_quick_start.</br>
After copying set kernel to Python(reco).</br>
Copy Dataset to Recommenders\examples\00_quick_start</br>
Run the notebook</br></br>
RBM Snack Recommendation.ipynb will generate rbm_recomm.csv which is futher used in FastApi </br>
ncf_final.ipynb will generate ncf_recomm.csv.</br>

## Algorithm Reference

| Algorithm | Environment | Type | Description |
| --- | --- | --- | --- |
| Neural Collaborative Filtering (NCF) | [Python CPU / Python GPU](examples/00_quick_start/ncf_movielens.ipynb) | Collaborative Filtering | Deep learning algorithm with enhanced performance for implicit feedback |
| Restricted Boltzmann Machines (RBM) | [Python CPU / Python GPU](examples/00_quick_start/rbm_movielens.ipynb) | Collaborative Filtering | Neural network based algorithm for learning the underlying probability distribution for explicit or implicit feedback |

## Neural Collaborative Filtering (NCF)

Neural Collaborative Filtering (NCF), which is an innovative algorithm based on deep neural networks to tackle the key problem in recommendation ‚Äî collaborative filtering ‚Äî on the basis of implicit feedback</br>
### 1 Matrix factorization algorithm
NCF is new neural matrix factorization model, which ensembles Generalized Matrix Factorization (GMF) and Multi-Layer Perceptron (MLP) to unify the strengths of linearity of MF and non-linearity of MLP for modelling the user‚Äìitem latent structures. NCF can be demonstrated as a framework for GMF and MLP, which is illustrated as below:
![Alt text](https://github.com/rhnyewale/INFO7374-Algorithmic-Digital-Marketing/blob/master/Assignment%204%20-%20Snack%20Recommender%20System/Images/NCF.jpg)
This figure shows how to utilize latent vectors of items and users, and then how to fuse outputs from GMF Layer (left) and MLP Layer (right). We will introduce this framework and show how to learn the model parameters in following sections.

## Restricted Boltzmann Machines (RBM)
A Restricted Boltzmann Machine (RBM) is a generative neural network model typically used to perform unsupervised learning. The main task of an RBM is to learn the joint probability distribution  ùëÉ(ùë£,‚Ñé) , where  ùë£  are the visible units and  ‚Ñé  the hidden ones. The hidden units represent latent variables while the visible units are clamped on the input data. Once the joint distribution is learnt, new examples are generated by sampling from it.</br>
The entire workflow is summarised below
![Alt text](https://github.com/rhnyewale/INFO7374-Algorithmic-Digital-Marketing/blob/master/Assignment%204%20-%20Snack%20Recommender%20System/Images/RBM.jpg)

## FastApi

Folder FastApi:</br> 
app.py - API for NCF Algorithm</br>
app1.py - API for RBM Algorithm</br>
1. Install uvicorn
2. run app.py using uvicorn app:app --reload | http://127.0.0.1:8000/items/ + userID
3. run app1.py using cmd python app1.py | http://127.0.0.1:8081/items/ + userID

## Streamlit App
Enter <b>UserId</b> and click the checkbox 'View Your Activity'</br>
Users Food Trend Analysis:</br>
1. No. of Fooditems for each Rating</br>
2. Count of Food Category </br>
3. Avg rating for each Food Category </br>

On the sidebar there are 2 checkboxes:
1. NCF Algorithm - Displays Dataframe of top 10 Snack Recommendation with prediction score 0-1
2. RBM Algorithm - Displays Dataframe of top 10 Snacks Recommendation with prediction score 0-5<br><br>
![Alt text](https://github.com/rhnyewale/INFO7374-Algorithmic-Digital-Marketing/blob/master/Assignment%204%20-%20Snack%20Recommender%20System/Images/streamlit_ncf_rbm.png)
